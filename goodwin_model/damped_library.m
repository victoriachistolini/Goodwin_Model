
% randomly selects n_cell number of parameter sets from library
% seletion is done with replacement 
function psets = damped_library(n_cells,sample)


% parameter sets
p1 = [ 0.6834    1.2024    3.0967    0.4280    1.0338    0.7700    0.2918    0.9410    0.6805    0.3648    0.8330    0.3665    0.8787    1.0066    0.4261    1.0327    0.5541];
p2 = [ 0.6021    0.9745    4.0658    0.3762    0.9727    0.8103    0.3332    1.0328    0.7465    0.3530    1.0881    0.3613    0.9216    0.8195    0.4743    0.9395    0.5052];
p3 = [ 0.7394    1.0114    3.6381    0.3336    0.9875    0.8035    0.3199    1.0785    0.7216    0.3418    0.8943    0.3401    0.9913    0.8531    0.4077    0.9178    0.4953];
p4 = [ 0.6782    0.9430    3.5897    0.3182    0.9790    0.5811    0.3713    0.9882    0.7489    0.3594    1.0494    0.2981    0.8980    0.9553    0.4044    1.1129    0.4855];
p5 = [ 0.7077    1.1814    4.1248    0.4132    0.9277    0.7369    0.3409    1.0600    0.7416    0.2735    0.8673    0.2996    1.0402    1.1470    0.3869    1.0812    0.5273];
p6 = [ 0.6309    1.0760    3.7371    0.3289    1.0177    0.6785    0.3454    1.0595    0.7733    0.3431    1.0328    0.3417    1.0230    1.0440    0.3753    1.0275    0.5301];
p7 = [ 0.6952    0.9493    4.0943    0.3586    1.0070    0.6574    0.3072    1.0317    0.6060    0.3139    1.1331    0.3353    0.9860    1.0900    0.3880    1.1029    0.4827];
p8 = [ 0.7709    1.0629    3.9148    0.3197    0.8957    0.6811    0.3347    0.9591    0.7688    0.3396    1.1144    0.3314    1.0973    0.9478    0.4071    1.0971    0.4793];
p9 = [ 0.6456    1.0567    3.4470    0.3586    1.0808    0.7149    0.3808    1.2039    0.7647    0.3593    1.0642    0.3649    0.8685    0.9584    0.4490    0.9956    0.5291];
p10 =[ 0.6825    1.0504    3.6429    0.4168    1.0122    0.7733    0.3421    0.9837    0.7483    0.3695    0.8880    0.2964    0.8902    0.8584    0.4024    0.9589    0.4816];
p11 =[ 0.7376    1.1834    3.0965    0.3802    1.0319    0.6085    0.3348    1.0343    0.9505    0.4469    0.8650    0.4562    1.0725    0.9937    0.4286    0.9795    0.4938];
p12 =[ 0.6441    1.1019    3.9467    0.3250    1.1351    0.6843    0.3294    0.9706    0.6406    0.3108    1.2526    0.4079    1.0308    0.8743    0.3654    0.9823    0.5396];
p13 =[ 0.6834    1.2024    3.0967    0.4280    1.0338    0.7700    0.2918    0.9410    0.6805    0.3648    0.8330    0.3665    0.8787    1.0066    0.4261    1.0327    0.5541];
p14 =[ 0.5872    0.9976    3.2205    0.3857    1.0862    0.7001    0.3475    0.7514    0.7407    0.2733    0.7681    0.3528    0.9052    1.0411    0.4271    1.0858    0.4654];
p15 =[ 0.6021    0.9745    4.0658    0.3762    0.9727    0.8103    0.3332    1.0328    0.7465    0.3530    1.0881    0.3613    0.9216    0.8195    0.4743    0.9395    0.5052];
p16 =[ 0.7394    1.0114    3.6381    0.3336    0.9875    0.8035    0.3199    1.0785    0.7216    0.3418    0.8943    0.3401    0.9913    0.8531    0.4077    0.9178    0.4953];
p17 =[ 0.6782    0.9430    3.5897    0.3182    0.9790    0.5811    0.3713    0.9882    0.7489    0.3594    1.0494    0.2981    0.8980    0.9553    0.4044    1.1129    0.4855];
p18 =[ 0.6309    1.0760    3.7371    0.3289    1.0177    0.6785    0.3454    1.0595    0.7733    0.3431    1.0328    0.3417    1.0230    1.0440    0.3753    1.0275    0.5301];
p19 =[ 0.6834    1.2024    3.0967    0.4280    1.0338    0.7700    0.2918    0.9410    0.6805    0.3648    0.8330    0.3665    0.8787    1.0066    0.4261    1.0327    0.5541];   
p20 =[ 0.5872    0.9976    3.2205    0.3857    1.0862    0.7001    0.3475    0.7514    0.7407    0.2733    0.7681    0.3528    0.9052    1.0411    0.4271    1.0858    0.4654];
p21 =[ 0.6021    0.9745    4.0658    0.3762    0.9727    0.8103    0.3332    1.0328    0.7465    0.3530    1.0881    0.3613    0.9216    0.8195    0.4743    0.9395    0.5052];
p22 =[ 0.7394    1.0114    3.6381    0.3336    0.9875    0.8035    0.3199    1.0785    0.7216    0.3418    0.8943    0.3401    0.9913    0.8531    0.4077    0.9178    0.4953];
p23 =[ 0.6782    0.9430    3.5897    0.3182    0.9790    0.5811    0.3713    0.9882    0.7489    0.3594    1.0494    0.2981    0.8980    0.9553    0.4044    1.1129    0.4855];
p24 =[ 0.7077    1.1814    4.1248    0.4132    0.9277    0.7369    0.3409    1.0600    0.7416    0.2735    0.8673    0.2996    1.0402    1.1470    0.3869    1.0812    0.5273];
p25 =[ 0.6264    1.0397    3.6992    0.4031    0.9967    0.8145    0.3351    1.0589    0.6956    0.2792    0.9018    0.3714    0.9945    0.8881    0.3749    1.0250    0.4503];
p26 =[ 0.6309    1.0760    3.7371    0.3289    1.0177    0.6785    0.3454    1.0595    0.7733    0.3431    1.0328    0.3417    1.0230    1.0440    0.3753    1.0275    0.5301];
p27 =[ 0.7065    1.1730    3.7566    0.3242    0.8250    0.7637    0.3803    0.9920    0.7629    0.3564    1.0291    0.3540    1.0440    1.0102    0.5115    0.8833    0.4073];
p28 =[ 0.6952    0.9493    4.0943    0.3586    1.0070    0.6574    0.3072    1.0317    0.6060    0.3139    1.1331    0.3353    0.9860    1.0900    0.3880    1.1029    0.4827];
p29 =[ 0.7709    1.0629    3.9148    0.3197    0.8957    0.6811    0.3347    0.9591    0.7688    0.3396    1.1144    0.3314    1.0973    0.9478    0.4071    1.0971    0.4793];
p30 =[ 0.6456    1.0567    3.4470    0.3586    1.0808    0.7149    0.3808    1.2039    0.7647    0.3593    1.0642    0.3649    0.8685    0.9584    0.4490    0.9956    0.5291];
p31 =[ 0.7551    0.9998    4.0372    0.3368    0.8517    0.6969    0.3836    1.1738    0.6699    0.2930    1.0166    0.3632    0.9773    0.8851    0.4810    0.7640    0.4745];
p32 =[ 0.6825    1.0504    3.6429    0.4168    1.0122    0.7733    0.3421    0.9837    0.7483    0.3695    0.8880    0.2964    0.8902    0.8584    0.4024    0.9589    0.4816];
p33 =[ 0.6047    1.0780    4.1758    0.3469    1.1021    0.6388    0.3645    1.0348    0.7244    0.3245    1.0327    0.3320    0.9104    0.8797    0.4415    0.9154    0.4914];
p34 =[ 0.6154    0.9703    2.7072    0.3120    0.8574    0.6290    0.3425    0.9675    0.8361    0.3300    0.9750    0.2951    0.9523    0.8662    0.4012    1.0853    0.5202];






% each row is a cell in matrix
param_sets = [p1;p2;p3;p4;p5;p6;p7;p8;p9;p10;p11;p12;p13;p14;p15;p16;p17;p18;p19;p20;p21;p22;p23;p24;p25;p26;p27;p28;p29;p30;p31;p32;p33;p34];

if sample == 1
    % draw random sample of cells with replacement
    index = randsample(1:18, n_cells, true);

    % return matrix such that each column is a cell
    psets = param_sets(index,:)';
else
    psets = param_sets;
end
