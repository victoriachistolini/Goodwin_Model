% parameter sets
p1 = [ 0.6834    1.2024    3.0967    0.4280    1.0338    0.7700    0.2918    0.9410    0.6805    0.3648    0.8330    0.3665    0.8787    1.0066    0.4261    1.0327    0.5541];
p2 = [ 0.6021    0.9745    4.0658    0.3762    0.9727    0.8103    0.3332    1.0328    0.7465    0.3530    1.0881    0.3613    0.9216    0.8195    0.4743    0.9395    0.5052];
p3 = [ 0.7394    1.0114    3.6381    0.3336    0.9875    0.8035    0.3199    1.0785    0.7216    0.3418    0.8943    0.3401    0.9913    0.8531    0.4077    0.9178    0.4953];
p4 = [ 0.6782    0.9430    3.5897    0.3182    0.9790    0.5811    0.3713    0.9882    0.7489    0.3594    1.0494    0.2981    0.8980    0.9553    0.4044    1.1129    0.4855];
p5 = [ 0.7077    1.1814    4.1248    0.4132    0.9277    0.7369    0.3409    1.0600    0.7416    0.2735    0.8673    0.2996    1.0402    1.1470    0.3869    1.0812    0.5273];
p6 = [ 0.6309    1.0760    3.7371    0.3289    1.0177    0.6785    0.3454    1.0595    0.7733    0.3431    1.0328    0.3417    1.0230    1.0440    0.3753    1.0275    0.5301];
p7 = [ 0.6952    0.9493    4.0943    0.3586    1.0070    0.6574    0.3072    1.0317    0.6060    0.3139    1.1331    0.3353    0.9860    1.0900    0.3880    1.1029    0.4827];
p8 = [ 0.7709    1.0629    3.9148    0.3197    0.8957    0.6811    0.3347    0.9591    0.7688    0.3396    1.1144    0.3314    1.0973    0.9478    0.4071    1.0971    0.4793];
p9 = [ 0.6456    1.0567    3.4470    0.3586    1.0808    0.7149    0.3808    1.2039    0.7647    0.3593    1.0642    0.3649    0.8685    0.9584    0.4490    0.9956    0.5291];
p10 =[ 0.6825    1.0504    3.6429    0.4168    1.0122    0.7733    0.3421    0.9837    0.7483    0.3695    0.8880    0.2964    0.8902    0.8584    0.4024    0.9589    0.4816];
p11 =[ 0.7376    1.1834    3.0965    0.3802    1.0319    0.6085    0.3348    1.0343    0.9505    0.4469    0.8650    0.4562    1.0725    0.9937    0.4286    0.9795    0.4938];
p12 =[ 0.6441    1.1019    3.9467    0.3250    1.1351    0.6843    0.3294    0.9706    0.6406    0.3108    1.2526    0.4079    1.0308    0.8743    0.3654    0.9823    0.5396];
p13 =[ 0.6834    1.2024    3.0967    0.4280    1.0338    0.7700    0.2918    0.9410    0.6805    0.3648    0.8330    0.3665    0.8787    1.0066    0.4261    1.0327    0.5541];
p14 =[ 0.5872    0.9976    3.2205    0.3857    1.0862    0.7001    0.3475    0.7514    0.7407    0.2733    0.7681    0.3528    0.9052    1.0411    0.4271    1.0858    0.4654];
p15 =[ 0.6021    0.9745    4.0658    0.3762    0.9727    0.8103    0.3332    1.0328    0.7465    0.3530    1.0881    0.3613    0.9216    0.8195    0.4743    0.9395    0.5052];
p16 =[ 0.7394    1.0114    3.6381    0.3336    0.9875    0.8035    0.3199    1.0785    0.7216    0.3418    0.8943    0.3401    0.9913    0.8531    0.4077    0.9178    0.4953];
p17 =[ 0.6782    0.9430    3.5897    0.3182    0.9790    0.5811    0.3713    0.9882    0.7489    0.3594    1.0494    0.2981    0.8980    0.9553    0.4044    1.1129    0.4855];
p18 =[ 0.6309    1.0760    3.7371    0.3289    1.0177    0.6785    0.3454    1.0595    0.7733    0.3431    1.0328    0.3417    1.0230    1.0440    0.3753    1.0275    0.5301];
p19 =[ 0.6834    1.2024    3.0967    0.4280    1.0338    0.7700    0.2918    0.9410    0.6805    0.3648    0.8330    0.3665    0.8787    1.0066    0.4261    1.0327    0.5541];   
p20 =[ 0.5872    0.9976    3.2205    0.3857    1.0862    0.7001    0.3475    0.7514    0.7407    0.2733    0.7681    0.3528    0.9052    1.0411    0.4271    1.0858    0.4654];
p21 =[ 0.6021    0.9745    4.0658    0.3762    0.9727    0.8103    0.3332    1.0328    0.7465    0.3530    1.0881    0.3613    0.9216    0.8195    0.4743    0.9395    0.5052];
p22 =[ 0.7394    1.0114    3.6381    0.3336    0.9875    0.8035    0.3199    1.0785    0.7216    0.3418    0.8943    0.3401    0.9913    0.8531    0.4077    0.9178    0.4953];
p23 =[ 0.6782    0.9430    3.5897    0.3182    0.9790    0.5811    0.3713    0.9882    0.7489    0.3594    1.0494    0.2981    0.8980    0.9553    0.4044    1.1129    0.4855];
p24 =[ 0.7077    1.1814    4.1248    0.4132    0.9277    0.7369    0.3409    1.0600    0.7416    0.2735    0.8673    0.2996    1.0402    1.1470    0.3869    1.0812    0.5273];
p25 =[ 0.6264    1.0397    3.6992    0.4031    0.9967    0.8145    0.3351    1.0589    0.6956    0.2792    0.9018    0.3714    0.9945    0.8881    0.3749    1.0250    0.4503];
p26 =[ 0.6309    1.0760    3.7371    0.3289    1.0177    0.6785    0.3454    1.0595    0.7733    0.3431    1.0328    0.3417    1.0230    1.0440    0.3753    1.0275    0.5301];
p27 =[ 0.7065    1.1730    3.7566    0.3242    0.8250    0.7637    0.3803    0.9920    0.7629    0.3564    1.0291    0.3540    1.0440    1.0102    0.5115    0.8833    0.4073];
p28 =[ 0.6952    0.9493    4.0943    0.3586    1.0070    0.6574    0.3072    1.0317    0.6060    0.3139    1.1331    0.3353    0.9860    1.0900    0.3880    1.1029    0.4827];
p29 =[ 0.7709    1.0629    3.9148    0.3197    0.8957    0.6811    0.3347    0.9591    0.7688    0.3396    1.1144    0.3314    1.0973    0.9478    0.4071    1.0971    0.4793];
p30 =[ 0.6456    1.0567    3.4470    0.3586    1.0808    0.7149    0.3808    1.2039    0.7647    0.3593    1.0642    0.3649    0.8685    0.9584    0.4490    0.9956    0.5291];
p31 =[ 0.7551    0.9998    4.0372    0.3368    0.8517    0.6969    0.3836    1.1738    0.6699    0.2930    1.0166    0.3632    0.9773    0.8851    0.4810    0.7640    0.4745];
p32 =[ 0.6825    1.0504    3.6429    0.4168    1.0122    0.7733    0.3421    0.9837    0.7483    0.3695    0.8880    0.2964    0.8902    0.8584    0.4024    0.9589    0.4816];
p33 =[ 0.6047    1.0780    4.1758    0.3469    1.1021    0.6388    0.3645    1.0348    0.7244    0.3245    1.0327    0.3320    0.9104    0.8797    0.4415    0.9154    0.4914];
p34 =[ 0.6154    0.9703    2.7072    0.3120    0.8574    0.6290    0.3425    0.9675    0.8361    0.3300    0.9750    0.2951    0.9523    0.8662    0.4012    1.0853    0.5202];
p35 =[ 0.8497    1.0541    3.3836    0.3429    0.9500    0.7268    0.3644    1.0405    0.6745    0.3290    0.9410    0.3799    0.8147    0.9793    0.4108    0.9347    0.5239];
p36 =[ 0.6370    0.9714    3.8150    0.3357    0.9496    0.7863    0.3714    1.0059    0.5973    0.2931    0.8035    0.4412    1.0972    1.0257    0.3610    0.8854    0.5274];
p37 =[ 0.7368    1.1523    4.7194    0.3459    0.9680    0.7572    0.3672    1.0765    0.7545    0.2982    1.0540    0.3468    0.9240    0.9306    0.4513    0.9190    0.4382];
p38 =[ 0.6277    0.9677    4.3066    0.4111    0.8839    0.8664    0.4034    1.0169    0.6789    0.3255    1.0833    0.3257    0.9538    1.0884    0.4174    1.0897    0.5252];
p39 =[ 0.6530    1.0576    3.6888    0.3128    1.0553    0.6704    0.3627    0.9648    0.7189    0.2602    1.0466    0.4149    1.1039    1.0911    0.3904    1.0181    0.5122];
p40 =[ 0.7067    0.9170    3.8591    0.3439    0.9519    0.7586    0.4388    0.8677    0.7090    0.2995    1.1303    0.3993    0.8337    1.1944    0.3566    1.0227    0.5549];
p41 =[ 0.6626    1.1928    3.9295    0.3415    0.9102    0.6445    0.3166    1.0354    0.8118    0.3685    1.0854    0.3970    0.7500    0.9832    0.4141    1.0717    0.4348];
p42 =[ 0.6296    1.0791    3.9534    0.3694    0.9039    0.5856    0.3766    1.1193    0.8142    0.2964    0.8663    0.2984    0.9958    0.9384    0.4526    0.8545    0.4129];
p43 =[ 0.7144    1.1193    3.6789    0.3057    0.9851    0.5854    0.3506    1.0828    0.7152    0.2832    0.9463    0.3394    1.1814    1.0915    0.3977    1.1309    0.4478];
p44 =[ 0.7429    1.0289    4.1581    0.3195    0.9502    0.6925    0.3259    1.0332    0.8656    0.3331    1.0647    0.3138    1.1340    0.9031    0.4083    0.9381    0.5256];
p45 =[ 0.7291    0.9345    3.8815    0.2976    0.9095    0.6717    0.3246    0.9134    0.6705    0.3170    1.1342    0.3154    1.1818    0.9626    0.3419    0.9381    0.5467];
p46 =[ 0.7739    1.0160    4.1150    0.3722    0.8541    0.6593    0.2859    0.9551    0.7664    0.3751    1.2288    0.3558    0.7844    1.1689    0.4513    0.9417    0.5111];
p47 =[ 0.5989    0.9032    4.0808    0.3378    1.1290    0.7939    0.3297    1.0875    0.7977    0.3612    1.1623    0.3872    1.0214    1.0877    0.4078    0.9585    0.5179];
p48 =[ 0.7365    1.0397    3.8069    0.3419    1.0613    0.8178    0.3699    0.8794    0.7303    0.3468    0.9756    0.3423    0.9120    0.9679    0.3686    0.9635    0.5059];
p49 =[ 0.7544    0.7740    3.7742    0.3816    1.0395    0.7003    0.3653    1.1130    0.7108    0.3234    0.9820    0.3427    1.0897    1.0412    0.4219    1.0148    0.4819];
p50 =[ 0.7043    1.0217    3.4408    0.3563    1.0928    0.6923    0.4050    1.0560    0.6706    0.3446    0.9725    0.3584    1.0755    0.9708    0.4183    1.1755    0.5466];



% each row is a cell in matrix
param_sets = [p1;p2;p3;p4;p5;p6;p7;p8;p9;p10;p11;p12;p13;p14;p15;p16;p17;p18;p19;p20;p21;p22;p23;p24;p25;p26;p27;p28;p29;p30;p31;p32;p33;p34;p35;p36;p37;p38;p39;p40;p41;p42;p43;p44;p45;p46;p47;p48;p49;p50];

y = [0.05 0.5 .5 0.2 0.05 0.5 .5 0.2];

new_params = ones(17,2);
amps = ones(50);
pers = ones(50);
for i= 1:50
    % generate a new guassian scaled parameter set
    new_params(:,1) = param_sets(i,:);
    new_params(:,2)  =  param_sets(i,:);

    % simulate a single cell, determine if it oscilates  
    [t,z] = ode15s(@goodwin,0:0.1:1000, y,odeset('MaxStep',0.1),new_params,x_fun,2,0,0);

    amp = max(z(3000:4000,1)) - min(z(3000:4000,1));
    per = getPeriod(t(3000:4000), z(3000:4000,1));

    amps(i) = amp;
    pers(i) = per;
end 
% plot clock protein path 
% figure; plot( t(3000:4000), z(3000:4000,1))

figure; histogram(amps(:,1))
xlabel('Amplitude of Damped Library Cells');
ylabel('Frequency');

figure; histogram(pers(:,1))
xlabel('Period of Damped Library Cells');
ylabel('Frequency');
