p1 = [0.6534    0.8835   3.7102    0.3550    1.0196    0.7158    0.3477    1.0092    0.6833    0.3651    0.9319    0.3580    0.9576    0.9833    0.4111    1.0520    0.4721];
p2 = [0.7441    1.0330   3.9864    0.3466    0.9891    0.6894    0.3504    1.0026    0.7289    0.3767    1.0233    0.3463    1.0313    1.0092    0.3794    1.0475    0.5077];
p3 = [0.8122    1.1235   3.9081    0.2973    0.9555    0.6891    0.3597    0.9739    0.7310    0.3637    0.8749    0.3168    0.9259    0.9492    0.3872    1.0012    0.3485];
p4 = [0.7704    0.9349   4.1028    0.3169    0.8678    0.7647    0.3500    0.9945    0.7638    0.3708    1.0350    0.3938    1.0930    1.0240    0.3724    0.9348    0.5596];
p5 = [0.7315    1.0101   4.3304    0.3688    1.0898    0.6908    0.3448    1.1008    0.5513    0.3323    0.8729    0.3366    1.0649    1.0826    0.3594    0.9529    0.5069];
p6 = [0.6796    1.0302   4.1600    0.3175    0.9823    0.5508    0.3901    0.9371    0.6157    0.3411    0.8571    0.3493    0.9439    1.2178    0.4455    0.7503    0.5221];
p7 = [0.7235    0.9095   3.8847    0.3623    0.8164    0.7725    0.4349    1.0959    0.6779    0.3650    0.8964    0.4157    1.0941    1.0787    0.3650    1.0320    0.4721];
p8 = [0.7883    1.0475   4.4696    0.3544    0.9343    0.5963    0.3554    1.0819    0.6795    0.3311    0.9691    0.3116    0.9507    0.9819    0.4018    0.9936    0.5306];
p9 = [0.7682    0.9359   4.7235    0.3122    1.0199    0.5935    0.3247    0.9407    0.7281    0.3830    1.0300    0.3369    1.0815    1.0799    0.4048    1.0571    0.5206];
p10 =[0.6202    0.8907   3.8266    0.3441    0.9781    0.7379    0.3636    1.0751    0.8245    0.3928    0.8717    0.2685    1.0902    0.8164    0.4027    1.0035    0.6114];
p11 =[0.6693    1.2003   4.3804    0.3349    1.0649    0.6748    0.3747    1.1416    0.5877    0.3860    1.1458    0.3517    1.1746    1.0155    0.3505    0.7807    0.4833];
p12 =[0.7499    1.0317   4.1654    0.3298    1.0144    0.5853    0.3234    0.9181    0.7364    0.3495    0.8844    0.3497    0.9310    0.9333    0.4346    1.0113    0.5199];
p13 =[0.6295    1.0065   4.2401    0.3023    1.0348    0.6873    0.3171    0.9962    0.5673    0.2755    0.8823    0.3153    0.8827    0.8275    0.4115    0.8406    0.5055];
p14 =[0.6075    0.9364   4.1271    0.3548    0.9289    0.7544    0.3718    1.0647    0.6702    0.3867    1.0661    0.4378    1.1063    1.1157    0.4021    0.8712    0.4814];
p15 =[0.6470    0.9436   4.2221    0.3305    0.9105    0.6713    0.3444    1.0409    0.6333    0.3611    1.0078    0.3964    0.9787    0.9866    0.3531    0.8615    0.5155];
p16 =[0.8043    1.1409   4.5669    0.3735    0.8793    0.7502    0.4071    1.0489    0.7724    0.3754    0.9697    0.3603    0.9213    1.0888    0.3541    0.8931    0.4595];
p17 =[0.4939    1.1438   4.1301    0.3236    1.1370    0.5802    0.3464    0.9759    0.7223    0.3610    0.9135    0.3489    0.9835    1.0628    0.4437    1.1109    0.4568];
p18 =[0.6155    1.2908   4.3301    0.3983    0.8942    0.6672    0.3405    1.1098    0.6805    0.3746    0.7948    0.3376    0.9176    0.8423    0.4203    1.0282    0.5017];
p19 =[0.6066    1.1127   4.1401    0.3395    1.0023    0.6817    0.2887    0.9714    0.6418    0.3157    0.8844    0.3313    0.7997    1.0964    0.4208    0.9980    0.4983];
p20 =[0.6068    0.7670   3.4204    0.3617    1.0391    0.7316    0.3454    1.0184    0.6667    0.3802    0.8638    0.3659    0.9151    0.9665    0.4221    1.1039    0.4441];
p21 =[0.7000    1.0000   4.0000    0.3500    1.0000    0.7000    0.3500    1.0000    0.7000    0.3500    1.0000    0.3500    1.0000    1.0000    0.4000    1.0000    0.5000];
p22 =[0.7070    0.9455   4.1214    0.3290    1.0490    0.7518    0.4099    0.9806    0.5503    0.3206    1.1355    0.3125    1.0961    1.0124    0.4575    0.8039    0.4901];
p23 =[0.8122    1.1235   3.9081    0.2973    0.9555    0.6891    0.3597    0.9739    0.7310    0.3637    0.8749    0.3168    0.9259    0.9492    0.3872    1.0012    0.3485];
p24 =[0.6680    1.1242   3.5733    0.3827    1.0350    0.6980    0.3564    0.8435    0.6941    0.4061    1.0098    0.3514    0.9266    0.9969    0.4093    1.0426    0.4814];
p25 =[0.7704    0.9349   4.1028    0.3169    0.8678    0.7647    0.3500    0.9945    0.7638    0.3708    1.0350    0.3938    1.0930    1.0240    0.3724    0.9348    0.5596];
p26 =[0.7315    1.0101   4.3304    0.3688    1.0898    0.6908    0.3448    1.1008    0.5513    0.3323    0.8729    0.3366    1.0649    1.0826    0.3594    0.9529    0.5069];
p27 =[0.6796    1.0302   4.1600    0.3175    0.9823    0.5508    0.3901    0.9371    0.6157    0.3411    0.8571    0.3493    0.9439    1.2178    0.4455    0.7503    0.5221];
p28 =[0.7235    0.9095   3.8847    0.3623    0.8164    0.7725    0.4349    1.0959    0.6779    0.3650    0.8964    0.4157    1.0941    1.0787    0.3650    1.0320    0.4721];
p29 =[0.7883    1.0475   4.4696    0.3544    0.9343    0.5963    0.3554    1.0819    0.6795    0.3311    0.9691    0.3116    0.9507    0.9819    0.4018    0.9936    0.5306];
p30 =[0.7682    0.9359   4.7235    0.3122    1.0199    0.5935    0.3247    0.9407    0.7281    0.3830    1.0300    0.3369    1.0815    1.0799    0.4048    1.0571    0.5206];
p31 =[0.6202    0.8907   3.8266    0.3441    0.9781    0.7379    0.3636    1.0751    0.8245    0.3928    0.8717    0.2685    1.0902    0.8164    0.4027    1.0035    0.6114];
p32 =[0.6693    1.2003   4.3804    0.3349    1.0649    0.6748    0.3747    1.1416    0.5877    0.3860    1.1458    0.3517    1.1746    1.0155    0.3505    0.7807    0.4833];
p33 =[0.7499    1.0317   4.1654    0.3298    1.0144    0.5853    0.3234    0.9181    0.7364    0.3495    0.8844    0.3497    0.9310    0.9333    0.4346    1.0113    0.5199];
p34 =[0.7619    1.0180   4.2203    0.3739    1.1171    0.7333    0.3994    1.0023    0.6966    0.4095    0.9490    0.3499    1.0920    1.0150    0.4562    1.1034    0.5146];
p35 =[0.6295    1.0065   4.2401    0.3023    1.0348    0.6873    0.3171    0.9962    0.5673    0.2755    0.8823    0.3153    0.8827    0.8275    0.4115    0.8406    0.5055];
p36 =[0.6075    0.9364    4.1271   0.3548    0.9289    0.7544    0.3718    1.0647    0.6702    0.3867    1.0661    0.4378    1.1063    1.1157    0.4021    0.8712    0.4814];
p37 =[0.6470    0.9436    4.2221   0.3305    0.9105    0.6713    0.3444    1.0409    0.6333    0.3611    1.0078    0.3964    0.9787    0.9866    0.3531    0.8615    0.5155];
p38 =[0.6510    0.8369    4.5840   0.4218    1.0121    0.6307    0.3919    0.9407    0.6671    0.3810    0.8615    0.2815    1.0421    1.0401    0.4038    1.0497    0.5541];
p39 =[0.7679    0.9431    4.3240   0.3561    0.9494    0.6165    0.3726    0.9646    0.7033    0.3222    0.8449    0.3560    0.9938    1.1199    0.4321    1.1053    0.4626];
p40 =[0.6345    0.8731    4.1992   0.4476    1.0728    0.6459    0.3793    0.8872    0.6003    0.3751    0.9222    0.3611    1.1407    1.0401    0.4372    0.8394    0.5331];
p41 =[0.6950    0.9062    4.0645   0.3406    0.9590    0.6502    0.3522    0.8154    0.6721    0.3310    0.9088    0.3728    0.9266    1.0541    0.4390    0.9843    0.5139];
p42 =[0.7448    0.9919    4.2163   0.3058    1.1110    0.6307    0.2860    1.1384    0.6956    0.3657    0.9637    0.3143    0.6927    1.0626    0.3885    0.9803    0.5203];
p43 =[0.6006    0.9271    4.4589   0.3709    0.8719    0.5458    0.3300    1.0214    0.7660    0.3533    0.8878    0.3607    0.8828    0.9039    0.3739    0.8771    0.4865];
p44 =[0.8096    0.8307    3.8202   0.3470    0.8008    0.7589    0.3355    1.1912    0.6726    0.3643    0.8858    0.3281    0.8831    1.0393    0.4521    0.9406    0.5218];
p45 =[0.6647    1.0102    4.4785   0.3542    0.8963    0.6400    0.3441    0.9808    0.6394    0.3563    1.1267    0.3412    0.9795    0.7798    0.3690    0.8607    0.4807];
p46 =[0.7150    1.2011    4.0102   0.3608    0.9062    0.8172    0.3544    1.0530    0.6334    0.3799    1.0389    0.3095    1.0040    0.9549    0.4044    0.9749    0.4905];
p47 =[0.6719    0.9486    4.3185   0.3265    1.1187    0.7553    0.3601    1.0003    0.7256    0.4734    0.9888    0.2955    1.1915    1.0610    0.3741    1.2617    0.5275];
p48 =[0.7206    0.9222    3.5740   0.2881    0.9577    0.6263    0.3727    0.9682    0.8238    0.4029    1.0164    0.3401    1.1152    0.8853    0.4269    0.9331    0.4800];
p49 =[0.7103    1.2296    5.1010   0.3548    0.8093    0.6745    0.3203    0.9235    0.6211    0.3527    1.2107    0.3249    0.9719    1.1166    0.4485    1.0486    0.5513];
p50 =[0.7610    0.9618    4.1716   0.3395    0.9100    0.7444    0.3524    0.9813    0.7204    0.3846    1.0393    0.3568    1.0280    1.0051    0.3690    1.0787    0.5704];
p51 =[0.6756    1.1413    4.6010   0.3756    1.0491    0.6590    0.3761    0.9172    0.7402    0.3599    1.1139    0.3351    1.0636    1.0793    0.3641    1.0156    0.5799];
p52 =[0.7079    0.9691    4.1827   0.3404    1.0443    0.6906    0.3494    1.0461    0.7954    0.3658    1.1648    0.2790    0.9551    1.0236    0.3666    0.8724    0.5309];
p53 =[0.7008    0.9956    5.1796   0.3279    0.9953    0.8878    0.3099    1.0553    0.6246    0.3861    1.0328    0.3728    0.9721    1.0245    0.4589    0.7725    0.4183];
p54 =[0.7546    1.0385    4.2785   0.3461    0.9961    0.7062    0.3224    1.1423    0.7004    0.3740    0.9145    0.3124    0.9909    0.9747    0.4478    1.0606    0.5270];
p55 =[0.7025    0.9635    4.7084   0.3577    1.2730    0.6793    0.3698    1.1583    0.8910    0.3606    0.9210    0.3781    0.8680    0.9726    0.4109    1.1490    0.5719];
p56 =[0.6981    1.0924    3.8715   0.3731    1.1915    0.7110    0.3395    0.9500    0.7502    0.3968    1.2126    0.3519    1.0163    0.9367    0.4645    0.9925    0.4763];
p57 =[0.8529    1.0810    4.2865   0.3148    1.0434    0.7364    0.3118    0.9774    0.6717    0.3685    0.8993    0.3881    1.1785    0.9696    0.3997    1.0507    0.5602];
p58 =[0.7122    0.9784    3.9390   0.3512    1.0458    0.7897    0.3717    0.9713    0.7419    0.3414    0.8219    0.2678    0.8286    0.9763    0.3752    0.9280    0.5020];
p59 =[0.6539    0.9369    4.2439   0.3774    1.2437    0.7212    0.3520    0.9426    0.6863    0.3482    0.8244    0.3410    1.0750    0.9429    0.4198    1.0991    0.5539];
p60 =[0.7578    0.9185    3.7863   0.3585    0.9899    0.5862    0.2970    1.1026    0.6469    0.4227    0.7778    0.3657    1.0001    0.9244    0.4162    0.9206    0.5430];








% each row is a cell in matrix
param_sets = [p1;p2;p3;p4;p5;p6;p7;p8;p9;p10;p11;p12;p13;p14;p15;p16;p17;p18;p19;p20;p21;p22;p23;p24;p25;p26;p27;p28;p29;p30;p31;p32;p33;p34;p35;p36;p37;p38;p39;p40;p41;p42;p43;p44;p45;p46;p47;p48;p49;p50;p51;p52;p53;p54;p55;p56;p57;p58;p59;p60];


y = [0.05 0.5 .5 0.2 0.05 0.5 .5 0.2];


%pulse function for light input (not used here)
x_fun = @(t)(step_on_end(t,0.7));


new_params = ones(17,2);
amps = ones(60);
pers = ones(60);
i=1;

for i= 1:60
    % generate a new guassian scaled parameter set
    new_params(:,1) = param_sets(i,:);
    new_params(:,2)  =  param_sets(i,:);

    % simulate a single cell, determine if it oscilates  
    [t,z] = ode15s(@goodwin,0:0.1:1000, y,odeset('MaxStep',0.1),new_params,x_fun,2,0,0);

    amp = max(z(3000:4000,1)) - min(z(3000:4000,1));
    per = getPeriod(t(3000:4000), z(3000:4000,1));

    amps(i) = amp;
    pers(i) = per;
end 
% plot clock protein path 
% figure; plot( t(3000:4000), z(3000:4000,1))

figure; histogram(amps(:,1))
xlabel('Amplitude of Sustained Library Cells');
ylabel('Frequency');

figure; histogram(pers(:,1))
xlabel('Period of Sustained Library Cells');
ylabel('Frequency');
